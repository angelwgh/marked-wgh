(function(d,a){d.dom=function(e){if(typeof(e)!=="string"){if((e instanceof Array)||(e[0]&&e.length)){return[].slice.call(e)}else{return[e]}}if(!d.__create_dom_div__){d.__create_dom_div__=a.createElement("div")}d.__create_dom_div__.innerHTML=e;return[].slice.call(d.__create_dom_div__.childNodes)};var b=0;var c=d.ListPicker=d.Class.extend({init:function(g,f){var e=this;if(!g){throw"构造 ListPicker 时找不到元素"}e.box=g;if(e.box.listpickerId){return}e.listpickerId=e.box.listpickerId="listpicker-"+(++b);e.box.setAttribute("data-listpicker-id",e.box.listpickerId);f=f||{};f.fiexdDur=f.fiexdDur||150;f.highlightStyle=f.highlightStyle||"color: green;";if(d.os.ios){f.enabledH5=true}if(f.enabled3d===null||typeof f.enabled3d==="undefined"){f.enabled3d=d.os.ios}e.options=f;e._create();e._handleShim();e._bindEvent();e._applyToBox();e._handleHighlight()},_create:function(){var e=this;e.boxInner=d(".mui-listpicker-inner",e.box)[0];e.boxHeight=e.box.offsetHeight;e.list=d("ul",e.boxInner)[0];e.refresh();var f=e.itemElementArray[0];e.itemHeight=0;if(f){e.itemHeight=f.offsetHeight}else{e.list.innerHTML="<li>...</li>";f=d("li",e.list)[0];e.itemHeight=f.offsetHeight;e.list.innerHTML=""}e.list.style.paddingTop=e.list.style.paddingBottom=(e.boxHeight/2-e.itemHeight/2)+"px";e.rule=d.dom('<div class="mui-listpicker-rule"> </div>')[0];e.rule.style.height=e.itemHeight+"px";e.rule.style.marginTop=-(e.itemHeight/2)+"px";e.box.appendChild(e.rule);e.middle=e.boxInner.offsetHeight/2;e.showLine=parseInt((e.boxInner.offsetHeight/e.itemHeight).toFixed(0));if(e.options.enabled3d){e.box.classList.add("three-dimensional")}},_handleShim:function(){var e=this;if(e.options.enabledH5){e.options.fiexdDur*=2;e.boxInner.classList.add(d.className("scroll-wrapper"));e.list.classList.add(d.className("scroll"));e._scrollerApi=d(e.boxInner).scroll({deceleration:0.002});e.setScrollTop=function(h,f,g){e._scrollerApi.scrollTo(0,-h,f)};e.getScrollTop=function(){var f=this;if(f._scrollerApi.lastY>0){return 0}else{return Math.abs(f._scrollerApi.lastY)}}}else{e.boxInner.addEventListener("scroll",function(f){if(e.disabledScroll){return}e.isScrolling=true;if(e.scrollTimer){clearTimeout(e.scrollTimer)}e.scrollTimer=setTimeout(function(){e.isScrolling=false;if(!e.isTouchDown||!d.os.ios){d.trigger(e.boxInner,"scrollend")}},150)},false);e.aniScrollTop=function(j,g,h){e.disabledScroll=true;var i=g>0?g/10:1;var f=(j-e.boxInner.scrollTop)/i;e._lastScrollTop=e.boxInner.scrollTop;e._aniScrollTop(j,0,i,f,h)};e._aniScrollTop=function(j,g,i,f,h){e.boxInner.scrollTop=e._lastScrollTop+f*g;if(g<i){setTimeout(function(){e._aniScrollTop(j,++g,i,f)},10)}else{e.disabledScroll=false;if(h){h()}}};e.setScrollTop=function(h,f,g){e.aniScrollTop(h,f)};e.getScrollTop=function(){var f=this;return f.boxInner.scrollTop};if(d.os.ios){e.boxInner.addEventListener("touchstart",function(g){var f=this;f.isTouchDown=true},false);e.boxInner.addEventListener("touchend",function(f){e.isTouchDown=false;if(!e.isScrolling){setTimeout(function(){d.trigger(e.boxInner,"scrollend")},0)}},false)}}},_handleHighlight:function(){var p=this;var g=p.getScrollTop();var m=parseInt((g/p.itemHeight).toFixed(0));var j=p.itemElementArray.length-1;var i=parseInt((p.showLine/2).toFixed(0));var e=m-i;var l=m+i;if(e<0){e=0}if(l>j){l=j}for(var k=e;k<=l;k++){var f=p.itemElementArray[k];if(k==m){f.classList.add(d.className("listpicker-item-selected"))}else{f.classList.remove(d.className("listpicker-item-selected"))}if(p.options.enabled3d){var o=p.middle-(f.offsetTop-g+p.itemHeight/2)+1;var n=o/p.itemHeight;var h=(18*n);f.style.webkitTransform="rotateX("+h+"deg) translate3d(0px,0px,"+(0-Math.abs(n*12))+"px)"}}},_triggerChange:function(){var e=this;d.trigger(e.box,"change",{index:e.getSelectedIndex(),v:e.getSelectedValue(),t:e.getSelectedText(),item:e.getSelectedItem(),element:e.getSelectedElement()})},_scrollEndHandle:function(){var e=this;var f=e.getScrollTop();var g=(f/e.itemHeight).toFixed(0);e.disabledScrollEnd=true;e.setSelectedIndex(g);e._triggerChange();e._handleHighlight();setTimeout(function(){e.disabledScrollEnd=false;e._handleHighlight()},e.options.fiexdDur)},_bindEvent:function(){var e=this;e.boxInner.addEventListener("scroll",function(f){e._handleHighlight(f)},false);e.disabledScrollEnd=false;e.boxInner.addEventListener("scrollend",function(f){if(e.disabledScrollEnd){return}e.disabledScrollEnd=true;e._scrollEndHandle()},false);d(e.boxInner).on("tap","li",function(k){var f=this;var g=[].slice.call(d("li",e.list));for(var h in g){var j=g[h];if(j==f){e.setSelectedIndex(h);return}}})},getSelectedIndex:function(){var e=this;return(e.getScrollTop()/e.itemHeight).toFixed(0)},setSelectedIndex:function(f,g){var e=this;f=(f||0);e.setScrollTop(e.itemHeight*f,g?0:e.options.fiexdDur)},getSelectedElement:function(){var e=this;var f=e.getSelectedIndex();return d("li",e.list)[f]},getSelectedItem:function(){var e=this;var f=e.getSelectedElement();if(!f){return null}var g=f.getAttribute("data-item");return g?JSON.parse(g):{t:f.innerText,v:f.getAttribute("data-value")}},refresh:function(){var e=this;e.itemElementArray=[].slice.call(d("li",e.list))},setItems:function(f){var e=this;var h=[];for(index in f){var g=f[index]||{t:"null",v:"null"+index};var i=JSON.stringify(g);h.push("<li data-value='"+g.v+"' data-item='"+i+"'>"+g.t+"</li>")}e.list.innerHTML=h.join("");if(e._scrollerApi&&e._scrollerApi.refresh){e._scrollerApi.refresh()}e.refresh();e._handleHighlight();e._triggerChange()},getItems:function(){var g=this;var f=[];var e=d("li",g.list);for(index in e){var h=e[index];var i=h.getAttribute("data-item");f.push(i?JSON.parse(i):{t:h.innerText,v:h.getAttribute("data-value")})}return f},getSelectedValue:function(){var e=this;var f=e.getSelectedItem();if(!f){return null}return f.v},getSelectedText:function(){var e=this;var f=e.getSelectedItem();if(!f){return null}return f.t},setSelectedValue:function(i,h){var f=this;var e=d("li",f.list);for(index in e){var g=e[index];if(!g||!g.getAttribute){continue}if(g.getAttribute("data-value")==i){f.setSelectedIndex(index,h);return}}},_applyToBox:function(){var f=this;var j=["getSelectedIndex","setSelectedIndex","getSelectedElement","getSelectedItem","setItems","getItems","getSelectedValue","getSelectedText","setSelectedValue"];var e=function(i){if(typeof f[i]==="function"){f.box[i]=function(){return f[i].apply(f,arguments)}}else{f.box[i]=f[i]}};for(var h in j){var g=j[h];e(g)}}});d.fn.listpicker=function(e){this.each(function(h,g){if(e){new c(g,e)}else{var j=g.getAttribute("data-listpicker-options");var f=j?JSON.parse(j):{};f.enabledH5=g.getAttribute("data-listpicker-enabledh5")||f.enabledH5;f.enabled3d=g.getAttribute("data-listpicker-enabled3d")||f.enabled3d;f.fixedDur=g.getAttribute("data-listpicker-fixddur")||f.fixedDur;new c(g,f)}});return this};d.ready(function(){d(".mui-listpicker").listpicker()})})(mui,document);